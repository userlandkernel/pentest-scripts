/*
 * Vanilla Javascript implementation of a directory fuzzer
 * Written by Sem Voigtl√§nder on March 26th 2019 
 * How to use: copy and paste this script into the console on the website you want to fuzz.
 * Note: You can specify a custom wordlist from any CORS accessible domain in the wordlist class.
 *
 * Happy responsible disclosure days, lets find and patch some bugs.
 *
*/

var Wordlist = function Wordlist(url = 'https://raw.githubusercontent.com/huntergregal/dir_list/master/files.txt')
{
	var req = new XMLHttpRequest();
	req.open('GET', url, false);
	req.send(null);
	this.words = req.responseText.split('\n');
};


var Dirscanner = function Dirscanner(wordlist = '')
{
	this.url = window.location.protocol+'//'+window.location.host+'/';
	this.results = [];

	var DirscannerRequest = function DirscannerRequest(url = '') {
		
		var DirscannerResponse = function DirscannerResponse(statuscode = 418, body = '', path = '') {
			this.statuscode = statuscode;
			this.body = body;
			this.path = path;
		};

		var req = new XMLHttpRequest();
		req.open('GET', url, false);
		req.send(null);

		return new DirscannerResponse(req.status, req.responseText, url);
	};

	this.scan = function() {
		for(i = 0; i < wordlist.words.length; i++)
		{
			var scanurl=this.url+wordlist.words[i];
			this.results.push(new DirscannerRequest(scanurl));
		}
	};
};

var Dirbuster = function()
{

	var wordlist = new Wordlist(); // Download default wordlist
	var scanner = new Dirscanner(wordlist); //Initialize a new scanner
	scanner.scan(); //fuzz the current domain 
	document.write(JSON.stringify(scanner.results)); //display the results.

}();
